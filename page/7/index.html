<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Sevens,JS,front-end" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="Sevens Chan blog">
<meta property="og:url" content="https://superhos.github.io/page/7/index.html">
<meta property="og:site_name" content="Sevens Chan blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sevens Chan blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://superhos.github.io/page/7/"/>





  <title>Sevens Chan blog</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Sevens Chan blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">陈日天技术博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/08/16/how-javascript-timers-work/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/16/how-javascript-timers-work/" itemprop="url">一起了解Javascript定时器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-16T00:00:00+08:00">
                2017-08-16
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/08/16/how-javascript-timers-work/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/08/16/how-javascript-timers-work/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一起了解Javascript定时器"><a href="#一起了解Javascript定时器" class="headerlink" title="一起了解Javascript定时器"></a>一起了解Javascript定时器</h3><p><a href="/studyforinterview/2017/08/16/how-javascript-timers-work/"><br>          2017-08-16
        </a></p>
<p><a href="https://superhos.github.io/studyforinterview/2017/07/25/起航/"><br>                        返回目录
                </a></p>
<p><a href="/studyforinterview/tags/Javascript/">#Javascript</a></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>这篇文章会聊聊关于Javascript的定时器以及它的执行机制，首先会先翻译一篇比较好的定时器和事件队列的文章，然后会根据一些经典的例题来更深入了解。</p>
<p>##<br>在基础层面上去了解 Javascript 定时器的工作原理是蛮重要的。因为单线程的问题很多时候他们的行为都是无意义的。让我们先来看看构建和操作Timers的函数。</p>
<ul>
<li><code>var id = setTimeout(fn,delay);</code> 初始化一个单次定时器，它会在设置的延迟时间(delay)后执行特定的回调函数。这个函数会返回一个唯一的ID，这个ID可以在之后用来取消这个定时器。</li>
<li><code>var id = setInterval(fn,delay);</code> 跟 <em>setTimeout</em> 类似，但是区别在于这个函数会多次执行直到它被停止。</li>
<li><code>clearInterval(id);clearTimeout(id);</code> 传入定时器的ID（ID由上面两个函数返回）然后停止定时器回调。</li>
</ul>
<p>为了了解定时器内部的运行原理，有一个很重要的概念我们需要探讨： 定时器延迟是不能保证的。因为所有的JS脚本都是在浏览器的单个线程上执行，异步事件在被触发的时候才会执行（例如鼠标事件和定时器），这个图可以很好的说清楚。</p>
<p><img src="https://johnresig.com/files/427px-Timers.png" alt="image_1"></p>
<p>这张图里面有很多知识点需要消化，但是完全理解了它就可以更好的帮助我们了解Javascript的异步事件机制的运作。这个图是一维的：垂直量度标记的是时间，单位是ms，蓝色框里面的是正在执行的Javascript部分。例如第一个Javascript部分执行了大概18ms，鼠标点击事件大概执行了11ms，以此类推。</p>
<p>因为Javascript只能一次执行一段代码（因为它的单线程性质），所有的代码块都会在线程里面堵塞其他的代码块。这意味着当异步事件发生的时候（例如鼠标点击事件，定时器触发或者一个XMLHttpRequest完成），它将会进入事件队列排队等待执行（这种排队实际上发生的情况肯定会因浏览器和浏览器之间的不同而有所不同，所以这里是一个简化的描述）。</p>
<p>首先，在第一个Javascript代码块中，两个定时器被启动：10ms的 setTimeout 和 10ms的 setInterval。定时器的启动时间和位置是在我们完成第一个代码块前就已经触发了。但是请注意，它不会立即执行（由于线程不能执行）。而是进入队列中以便再下一个可用时间执行。【译者补充：就是说会等第一代码块的顺序代码执行完后，回头才会去处理事件队列里面的代码。】</p>
<p>另外，在第一个Javascript代码块中我们还看到一个鼠标点击事件发生。与这个事件关联的异步回调函数也不会马上就执行（因为我们不会知道用户何时执行操作，因此这个时间也被认为是异步的），跟 timeout 事件初始化一样，它也会放入到队列里面稍后执行。</p>
<p>在初始化Javascript代码块执行完后浏览器马上会问一个问题：“还有谁？！谁在等着被执行？！” 在这个图的案例里面，鼠标点击回调事件和定时器的回调事件都在等着。浏览器会选择下一个队列事件（点击回调事件）并立即执行。timeout 的回调时间则会等待下一个时机去执行。</p>
<p>注意，当鼠标点击事件回调在执行的时候，第一个 interval 事件回调到达时间点执行，它会跟 timeout 的回调事件一样进入队列等待稍后执行。但是请注意，当 interval 再次被触发（当 timeout 的回调事件还在执行）的时候，这个 interval 的回调执行会被放弃。假如在执行大块代码块的时候对所有的 interval 回调进行排队，那么这一系列的回调之间将不会有延迟。但相反，浏览器事实上往往只是等待，在更多的其他的事件入队之前不会再有其他的 interval 回调事件(指相同ID interval衍生出来的回调事件) 会被放入队列。【译者补充：就是说，当一个占用时间较长的事件在执行的时候，如果队列中已经有一个相同ID interval产生的且还没执行的回调事件在，即使到达了再下一个得interval触发时间也不会有新的interval回调事件入队。】</p>
<p>事实上我们可以看到案例中第三个 interval 回调事件被触发的时候， 前一个 interval 回调事件正在执行。这告诉了我们一个事实：interval 回调事件不会在意什么当前执行的内容，它们会不加区分地进入队伍，即使回调事件之间的时间会被浪费掉。</p>
<p>最后在第二个 interval 回调事件执行完后，我们可以看到在javascipt引擎的队列里面已经没有东西可以执行了。这意味着浏览器现在会等待新的异步事件的发生。在 interval 回调事件再次触发的时候时间线已经到达50ms了，这一次，因为没有其他代码块在执行，所以这个 interval 回调事件会马上执行。</p>
<p>来看一个例子去更好地区分 <code>setTimeout</code> 和 <code>setInterval</code> ：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Some long block of code... */</span></span><br><span class="line"></span><br><span class="line">  setTimeout(<span class="built_in">arguments</span>.callee, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">&#125;, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Some long block of code... */</span></span><br><span class="line"></span><br><span class="line">&#125;, <span class="number">10</span>);</span><br></pre></td></tr></table></figure></p>
<p>乍看之下，这两个代码片段似乎实现的功能是一致的，但仔细看其实不同。值得注意的是， 在前一个回调执行之后，setTimeout 的代码至少会有10ms的延迟才会执行（可能会更多，但不会更少）。 setInterval 则在每10ms的时间里都会尝试去执行回调，而不会管前一个回调执行的完成时间。</p>
<p>今天学习了很多，我们来回顾一下：</p>
<ul>
<li>Javascript 引擎只有一个单线程，强制异步事件排队等待执行。</li>
<li>setTimeout 和 setInterval 在它们如何处理异步代码之上有着根本性的不同</li>
<li>如果定时器被阻止立即执行，它将被延迟到下一个可能的执行点（这将会比期望的延迟时间更长）。</li>
<li>如果 Interval 的回调事件需要花费足够长的时间执行，那么它们将可以无延迟的背靠背(连续)执行。</li>
</ul>
<p>这些都是重要的基础知识。了解Javascript引擎的工作原理，特别是遇到大量异步事件的情况下，可以在构建高级应用程序代码的基础层面上做好准备。</p>
<h2 id="经典例题"><a href="#经典例题" class="headerlink" title="经典例题"></a>经典例题</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(i)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第一题就是基础的不能再基础了顺序输出0 1 2 3 4</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line"></span><br><span class="line">	setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(i)</span><br><span class="line"></span><br><span class="line">	&#125;, <span class="number">1000</span> * i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二题就有我们上一节提到的知识了，javascript会先把for循环执行完，把setTimeout的回调事件都放到事件队列中，等初始块代码执行完后再去处理事件队列里的回调事件，而这个时候，for局部里面的变量 i 已经一早递加为 5 了（注意，for循环是先执行语句3再去判断能不能执行内部语句的，所以 i 已经是 5 了）。因此结果是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//延迟</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line"></span><br><span class="line">	(<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">		setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(i)</span><br><span class="line"></span><br><span class="line">		&#125;, <span class="number">1000</span> * i);</span><br><span class="line"></span><br><span class="line">	&#125;)(i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第三题用了一个匿名函数和马上执行的传参来包住了setTimeout，就是说setTimeout 的 i 这个时候用的是闭包里面的局部变量 i，因为匿名函数的 i 传参不是引用传值而是数值传值，所以匿名函数里的 i 不会根据外面for循环的变量 i 的改变而改变。因此结果是：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//延迟</span></span><br><span class="line"></span><br><span class="line"><span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line"></span><br><span class="line">	(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">		setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(i)</span><br><span class="line"></span><br><span class="line">		&#125;, <span class="number">1000</span> * i);</span><br><span class="line"></span><br><span class="line">	&#125;)(i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第四题考察的就是闭包的知识了，因为没有值传入，所以setTimeout读的还是已经跑完for循环的 i。因此结果是：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//延迟</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line"></span><br><span class="line">	setTimeout((<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(i)</span><br><span class="line"></span><br><span class="line">	&#125;)(i), <span class="number">1000</span> * i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第五题setTimeout里面的回调函数被立即匿名调用了，所以先会跟正常输出一样，不会延迟执行。同时因为匿名函数没有返回值，所以 setTimeout 的回调函数是 undefined。输出结果是：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//无延迟</span></span><br><span class="line"></span><br><span class="line"><span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line"></span><br><span class="line">	setTimeout((<span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">returnfunction()&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(i);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;)(i), <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据第五题的变形另外加一题，这题跟第五题的区别就是匿名函数有返回值，就是 setTimeout的回调函数就不再是undefined了，所以输出结果是：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//延迟</span></span><br><span class="line"></span><br><span class="line"><span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[0] 例题来源，小芋头君知乎live（如禁止发布请告知删除）</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/08/10/http-protocal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/10/http-protocal/" itemprop="url">关于HTTP协议的一切</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-10T00:00:00+08:00">
                2017-08-10
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/08/10/http-protocal/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/08/10/http-protocal/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="关于HTTP协议的一切"><a href="#关于HTTP协议的一切" class="headerlink" title="关于HTTP协议的一切"></a>关于HTTP协议的一切</h3><h2 id="怎么理解协议"><a href="#怎么理解协议" class="headerlink" title="怎么理解协议"></a>怎么理解协议</h2><p>在总结HTTP协议之前，先来讲讲什么是协议。做过游戏行业的人应该对此理解比较深刻，因为游戏的通信协议没有太通用的规范，都是框架制定时候来约定的。按我理解，协议就是服务端和客户端通信时候所采用的规范和格式。</p>
<h2 id="HTTP协议简介"><a href="#HTTP协议简介" class="headerlink" title="HTTP协议简介"></a>HTTP协议简介</h2><p>HTTP是Hyper Text Transfer Protocol（超文本传输协议）的缩写。它的发展是万维网协会（World Wide Web Consortium）和Internet工作小组IETF（Internet Engineering Task Force）合作的结果，（他们）最终发布了一系 列的RFC，RFC 1945定义了HTTP/1.0版本。其中最著名的就是RFC 2616。RFC 2616定义了今天普遍使用的一个版本——HTTP 1.1。<br>HTTP协议（HyperText Transfer Protocol，超文本传输协议）是用于从WWW服务器传输超文本到本地浏览器的传送协议。它可以使浏览器更加高效，使网络传输减少。它不仅保证计算 机正确快速地传输超文本文档，还确定传输文档中的哪一部分，以及哪部分内容首先显示(如文本先于图形)等。<br>HTTP是一个应用层协议，由请求和响应构成，是一个标准的客户端服务器模型。HTTP是一个无状态的协议。</p>
<p>关键词： 应用层协议，无状态协议<br>无状态协议的意思可以理解成请求之间是独立不影响的，因此服务端开发的时候需要引用session的概念来保持会话的持续性。</p>
<h2 id="HTTP协议的格式-Request"><a href="#HTTP协议的格式-Request" class="headerlink" title="HTTP协议的格式 - Request"></a>HTTP协议的格式 - Request</h2><p>HTTP Request由三个部分组成： 请求行，消息报头（Header），请求正文（body）</p>
<h2 id="格式实例"><a href="#格式实例" class="headerlink" title="格式实例"></a>格式实例</h2><p>POST /test/test/index HTTP/1.1</p>
<ul>
<li>POST： HTTP的请求方式</li>
<li>/test/test/index: 请求Web服务器的目录地址</li>
<li>HTTP/1.1: URI（Uniform Resource Identifier，统一资源标识符）及其版本</li>
</ul>
<h4 id="问题引申：URL和URI区别"><a href="#问题引申：URL和URI区别" class="headerlink" title="问题引申：URL和URI区别"></a>问题引申：URL和URI区别</h4><p><strong>URI 是统一资源标识符，而 URL 是统一资源定位符</strong>。因此，笼统地说，每个 URL 都是 URI，但不一定每个 URI 都是 URL。这是因为 URI 还包括一个子类，即统一资源名称 (URN)，它命名资源但不指定如何定位资源。例如 mailto、news 和 isbn URI 都是 URN 的示例。</p>
<p><strong>URI—Universal Resource Identifier通用资源标志符</strong></p>
<p>Web上可用的每种资源如HTML文档、图像、视频片段、程序等都是一个来URI来定位的<br>URI一般由三部组成</p>
<ul>
<li>访问资源的命名机制</li>
<li>存放资源的主机名</li>
<li>资源自身的名称，由路径表示，着重强调于资源。</li>
</ul>
<p><strong>URL—Uniform Resource Location统一资源定位符</strong></p>
<p>URL是Internet上用来描述信息资源的字符串，主要用在各种WWW客户程序和服务器程序上，特别是著名的Mosaic。采用URL可以用一种统一的格式来描述各种信息资源，包括文件、服务器的地址和目录等。<br>URL一般由三部组成</p>
<ul>
<li>协议(或称为服务方式)</li>
<li>存有该资源的主机IP地址(有时也包括端口号)</li>
<li>主机资源的具体地址。如目录和文件名等</li>
</ul>
<h3 id="Host"><a href="#Host" class="headerlink" title="Host"></a>Host</h3><p>请求的Web服务器域名地址</p>
<h4 id="User-Agent"><a href="#User-Agent" class="headerlink" title="User-Agent"></a>User-Agent</h4><p>HTTP客户端运行的浏览器类型的详细信息。通过该头部信息，Web服务器可以判断当前HTTP请求的客户端的浏览器类型。</p>
<p>例子：<br>User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.8.1.11) Gecko/20071127 Firefox/2.0.0.11</p>
<h4 id="Accept"><a href="#Accept" class="headerlink" title="Accept"></a>Accept</h4><p>指定客户端能够接受的内容类型，内容类型中的先后次序表示客户端接收的先后次序。</p>
<p>例子：<br>Accept:text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,/;q=0.5<br>备注：<br>在Prototyp（1.5）的Ajax代码封装中，将Accept默认设置为“text/JavaScript, text/html, application/xml, text/xml, /”。这是因为Ajax默认获取服务器返回的Json数据模式。<br>在Ajax代码中，可以使用XMLHttpRequest 对象中setRequestHeader函数方法来动态设置这些Header信息。</p>
<blockquote>
<p>注意：很多参数后面都会有’q’参数，根据HTTP协议的<a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html" target="_blank" rel="noopener">14.1章</a>，这个’q’参数可以理解喜好参数。例如上面q=0.9为最高，会优先选择text/plain类型,然后再到0.8最后0.5为空。</p>
</blockquote>
<h4 id="Accept-Language"><a href="#Accept-Language" class="headerlink" title="Accept-Language"></a>Accept-Language</h4><p>指定HTTP客户端浏览器用来展示返回信息所优先选择的语言</p>
<p>例子：<br>Accept-Language: zh-cn,zh;q=0.5<br>这里默认为中文。</p>
<h4 id="Accept-Encoding"><a href="#Accept-Encoding" class="headerlink" title="Accept-Encoding"></a>Accept-Encoding</h4><p>指定客户端浏览器可以支持的web服务器返回内容压缩编码类型。表示允许服务器在将输出内容发送到客户端以前进行压缩，以节约带宽。而这里设置的就是客户端浏览器所能够支持的返回压缩格式。 </p>
<p>例子：<br>Accept-Encoding: gzip,deflate<br>备注：<br>其实在百度很多产品线中，apache在给客户端返回页面数据之前，将数据以gzip格式进行压缩。</p>
<h4 id="Accept-Charset"><a href="#Accept-Charset" class="headerlink" title="Accept-Charset"></a>Accept-Charset</h4><p>浏览器可以接受的字符编码集</p>
<p>例子：<br>Accept-Charset: gb2312,utf-8;q=0.7,*;q=0.7</p>
<h4 id="Content-Type"><a href="#Content-Type" class="headerlink" title="Content-Type"></a>Content-Type</h4><p>显示此HTTP请求提交的内容类型。一般<strong>只有post提交时</strong>才需要设置该属性。</p>
<p>例子：<br>Content-type: application/x-www-form-urlencoded;charset:UTF-8<br>有关Content-Type属性值可以如下两种编码类型：<br>1.“application/x-www-form-urlencoded”： 表单数据向服务器提交时所采用的编码类型，默认的缺省值就是“application/x-www-form-urlencoded”。 然而，在向服务器发送大量的文本、包含非ASCII字符的文本或二进制数据时这种编码方式效率很低。<br>2.“multipart/form-data”： 在文件上载时，所使用的编码类型应当是“multipart/form-data”，它既可以发送文本数据，也支持二进制数据上载。<br>当提交为单单数据时，可以使用“application/x-www-form-urlencoded”；当提交的是文件时，就需要使用“multipart/form-data”编码类型。<br>在Content-Type属性当中还是指定提交内容的charset字符编码。一般不进行设置，它只是告诉web服务器post提交的数据采用的何种字符编码。<br>一般在开发过程，是由前端工程与后端UI工程师商量好使用什么字符编码格式来post提交的，然后后端ui工程师按照固定的字符编码来解析提交的数据。所以这里设置的charset没有多大作用。</p>
<h4 id="Connection"><a href="#Connection" class="headerlink" title="Connection"></a>Connection</h4><p>表示是否需要持久链接，如果Web服务器接收到值为”Keep-Alive”，或者看到请求使用的是HTTP 1.1(<strong>HTTP 1.1默认进行持久连接</strong>)，它就可以利用持久连接的优点，当页面包含多个元素时（例如Appley，图片），显著地减少下载所需要的时间。要实现这一点，Web服务器需要在返回客户端HTTP头信息中发送一个Content-Length头参数（返回信息正文的长度），最简单的实现方法就是：先把内容写入ByteArrayOutputStream，然 后在正式写出内容之前计算它的大小。 </p>
<p>例子：<br>Connection: keep-alive</p>
<h4 id="Keep-Alive"><a href="#Keep-Alive" class="headerlink" title="Keep-Alive"></a>Keep-Alive</h4><p>显示此HTTP连接的Keep-Alive时间，使客户端到服务端的连接持续有效，当出现对服务器的后续请求时，Keep-Alive功能避免了建立或者重新建立连接。<br>以前HTTP请求是一站式连接，从HTTP/1.1协议之后，就有了长连接，即在规定的Keep-Alive时间内，连接是不会断开的。 </p>
<p>例子：<br>Keep-Alive: 300</p>
<blockquote>
<p>可以保持长连接那么HTTP协议还是无状态的吗？答案是肯定的，因为保持长连接是保持TCP的连接，协议本身依然不会保存事务处理的信息。</p>
</blockquote>
<h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><p>HTTP请求发送时，会把保存在该请求域名下的所有cookie值一起发送给web服务器。</p>
<h4 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h4><p>包含一个URL，用户从该URL代表的页面出发访问当前请求的页面</p>
<h4 id="Cache-Control"><a href="#Cache-Control" class="headerlink" title="Cache-Control"></a>Cache-Control</h4><p>客户端是否支持cache。no-cache表示客户端不支持cache，如max-age=3600，告诉User Agent 该请求的响应结果在多长时间内有效，在有效期内，当用户再次需要访问时，直接从客户端本地提取，不需要访问服务器。</p>
<h4 id="Date"><a href="#Date" class="headerlink" title="Date"></a>Date</h4><p>消息产生的当前时间</p>
<p>例子：<br>Mon, 21 Aug 2017 07:50:24 GMT</p>
<h4 id="If-Modified-Since"><a href="#If-Modified-Since" class="headerlink" title="If-Modified-Since"></a>If-Modified-Since</h4><p>如果请求消息包含If-Modified-Since标题域，GET方法的语法就变成“条件GET”，即“（conditional GET）”。 条件GET方法可以对指定资源进行判断，如果它在If-Modified-Since标题域中的指定日期后发生了更新，才启动传输，否则不传输。这种条件GET允许被缓存的实体在不必经过多次请求或不必要的数据传输就能进行刷新，从而有助于降低网络负载。</p>
<h4 id="Last-Modified"><a href="#Last-Modified" class="headerlink" title="Last-Modified"></a>Last-Modified</h4><p>上次修改的时间</p>
<h4 id="ETag"><a href="#ETag" class="headerlink" title="ETag"></a>ETag</h4><p>一般应用在文件下载上，用于标识响应内容的最后修改时间或内容较验码，当下一次User agent需要时，服务首先判断这二个值是否跟服务器上一致，一样则不需要返回内容。</p>
<p>例子：<br>“1cbf3-dfd-3a2adcd8”</p>
<h4 id="Expires"><a href="#Expires" class="headerlink" title="Expires"></a>Expires</h4><p>该请求的响应结果在什么时间失效，在没有失效之前，代理可直接从缓存中返回以前的响应结果。</p>
<h4 id="Pragma"><a href="#Pragma" class="headerlink" title="Pragma"></a>Pragma</h4><p>包括实现特定的指令，它可应用到响应链上的任何接收方</p>
<p>例子：<br>Pragma: no-cache</p>
<h2 id="HTTP-Response"><a href="#HTTP-Response" class="headerlink" title="HTTP Response"></a>HTTP Response</h2><p>Response组成部分也有三部分：状态行，Header,Body</p>
<p>### </p>
<h3 id="HTTP-Response-Header"><a href="#HTTP-Response-Header" class="headerlink" title="HTTP Response Header"></a>HTTP Response Header</h3><p>Response的Header参数跟Request很多类似，重复的在此省略</p>
<h4 id="Status"><a href="#Status" class="headerlink" title="Status"></a>Status</h4><p>状态码</p>
<h4 id="Set-Cookie"><a href="#Set-Cookie" class="headerlink" title="Set-Cookie"></a>Set-Cookie</h4><p>服务端设置客户端cookie。设置格式是name=value，设置多个参数时中间分号隔开。Set-Cookie时还会用到几个参数：PATH设置有效路径，DOMAIN设置cookie生效的域名，Expire设置cookie的有效时间，0表示关闭浏览器就失效。</p>
<h4 id="Location"><a href="#Location" class="headerlink" title="Location"></a>Location</h4><p>当服务器返回3xx重定向时，该参数实现重定向。广告链接的跳转就使用这种协议。</p>
<h4 id="Content-Length"><a href="#Content-Length" class="headerlink" title="Content-Length"></a>Content-Length</h4><p>附属体（数据实体）的长度</p>
<h2 id="常见例题"><a href="#常见例题" class="headerlink" title="常见例题"></a>常见例题</h2><p>1.下面HTTP头中<strong>_</strong>不是和浏览器缓存相关<br>A. Expires<br>B. Cache-Control<br>C. ETag<br>D. Date</p>
<p>解析：Expires表示缓存过期的时间，Cache-Control表示缓存的规则(不保留或者或留多久)，ETag和Last-Modified配合使用查看是否读取缓存，Date是发送request的当前时间。所以答案选<strong>D</strong>。</p>
<h2 id="郭无心"><a href="#郭无心" class="headerlink" title=",郭无心"></a>,郭无心</h2><p>[4]《技术之瞳》,阿里巴巴集团校园招聘笔试项目组</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/08/08/jquery-plugin-develop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/08/jquery-plugin-develop/" itemprop="url">全家一起来开发一个Jquery插件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-08T00:00:00+08:00">
                2017-08-08
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/08/08/jquery-plugin-develop/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/08/08/jquery-plugin-develop/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="全家一起来开发一个Jquery插件"><a href="#全家一起来开发一个Jquery插件" class="headerlink" title="全家一起来开发一个Jquery插件"></a>全家一起来开发一个Jquery插件</h3><p><a href="/studyforinterview/2017/08/08/jquery-plugin-develop/"><br>          2017-08-08
        </a></p>
<p><a href="https://superhos.github.io/studyforinterview/2017/07/25/起航/"><br>                        返回目录
                </a></p>
<h2 id="小梦想"><a href="#小梦想" class="headerlink" title="小梦想"></a>小梦想</h2><p>我相信每个用过Jquery的人都有一个小梦想，就是写一个自己的Jquery插件——然后放上github，收获nk+星星，登上人生巅峰迎娶白富美。。我也不例外，在爱上vue.js以后回头来写Jquery有很多感觉都不一样了，JS的面向对象感觉理解更深了。</p>
<p>P.S:虽然Jquery已经不再是很多人的首选了，但作为曾经的绝对霸主级JS库，还是很多地方值得我们学习参考的。</p>
<h2 id="项目构建"><a href="#项目构建" class="headerlink" title="项目构建"></a>项目构建</h2><p>要放上github的话肯定又有“高颜值”啦，指的是整个项目的架构要规范。这里就直接使用grunt的脚手架来搭建项目：</p>
<p>当然，grunt的模板是需要自己下的。具体命令是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">git clone https://github.com/gruntjs/grunt-init-jquery.git ~/.grunt-init/jquery</span><br></pre></td></tr></table></figure></p>
<p>模板下好以后就可以去到我们的插件目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">grunt-int jquery</span><br></pre></td></tr></table></figure></p>
<p>然后<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></p>
<p>装好依赖包之后，看看我们的项目架构，好爽。。连README都有了。</p>
<h2 id="插件结构"><a href="#插件结构" class="headerlink" title="插件结构"></a>插件结构</h2><p>grunt模板里面给的插件结构也很漂亮，不过我还是个人的结构。</p>
<p>首先用闭包包着我们的插件，目的是防止$符号污染，因为$是很多库的宠儿，这里使用闭包确保我们闭包内的$是jquery对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;(function($,window,document)&#123;</span><br><span class="line"></span><br><span class="line">	//插件内容</span><br><span class="line"></span><br><span class="line">&#125;(jQuery,window,document));</span><br></pre></td></tr></table></figure>
<p>然后放入jquery扩展函数定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">;(function($,window,document)&#123;</span><br><span class="line"></span><br><span class="line">	//插件内容</span><br><span class="line"></span><br><span class="line">	$.fn.extend(&#123;</span><br><span class="line"></span><br><span class="line">		tagSelect: function (option)&#123;</span><br><span class="line"></span><br><span class="line">			var plugin = new TagSelect(this, option);</span><br><span class="line"></span><br><span class="line">			return plugin.init();</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	//TagSelect 类</span><br><span class="line"></span><br><span class="line">	var TagSelect = function (ele, opt)&#123;</span><br><span class="line"></span><br><span class="line">		//私有变量</span><br><span class="line"></span><br><span class="line">		this.$element = ele;</span><br><span class="line"></span><br><span class="line">		this.defaultSetting = &#123; </span><br><span class="line"></span><br><span class="line">			maxNum: 5,</span><br><span class="line"></span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		this.setting = $.extend(&#123;&#125;,this.defaultSetting, opt);</span><br><span class="line"></span><br><span class="line">		//私有函数</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	//公有函数</span><br><span class="line"></span><br><span class="line">	TagSelect.prototype = &#123;</span><br><span class="line"></span><br><span class="line">		init: function()&#123;	</span><br><span class="line"></span><br><span class="line">			return this.$element;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">&#125;(jQuery,window,document));</span><br></pre></td></tr></table></figure>
<p>tagSelect 是我们的插件名称，插件的定义和实现可以直接写在这个函数中，不过为了开发规范，我把这部分抽象出来。</p>
<p>再下面就是TagSelect类，插件的实际内容都在这里了，留意这一部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">this.defaultSetting = &#123; </span><br><span class="line"></span><br><span class="line">			maxNum: 5,</span><br><span class="line"></span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">this.setting = $.extend(&#123;&#125;,this.defaultSetting, opt);</span><br></pre></td></tr></table></figure>
<p>defaultSetting就是我们插件默认设置的设定，通过 $.extend() 函数把defaultSetting和opt合并在一起，重复部分使用后者的内容。</p>
<p>这个就是我们插件的整体结构了。</p>
<h2 id="插件的使用"><a href="#插件的使用" class="headerlink" title="插件的使用"></a>插件的使用</h2><p>因为直接用的是 $.fn.extend jquery的插件扩展机制，所以使用也是一句话的事情啦~~</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$(&apos;#target&apos;).tagSelect(&#123;</span><br><span class="line"></span><br><span class="line">	maxNum : 10</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>参数传的是设置，这样调用就把我们的maxNum设成了10了。</p>
<p>写到这里啦，有缺失部分再补充~</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/08/07/trans-rate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/07/trans-rate/" itemprop="url">传输速率计算问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-07T00:00:00+08:00">
                2017-08-07
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/08/07/trans-rate/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/08/07/trans-rate/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="传输速率计算问题"><a href="#传输速率计算问题" class="headerlink" title="传输速率计算问题"></a>传输速率计算问题</h3><h2 id="由一道题开始说起"><a href="#由一道题开始说起" class="headerlink" title="由一道题开始说起"></a>由一道题开始说起</h2><p><strong>使用一辆卡车运输n块装满数据的1TB硬盘，以80km/h行驶1000km将数据运送到目的地，卡车至少运送<em>__</em>块硬盘才能使速率超过1000G bit/s?</strong></p>
<p>解：<br>这就是关于传输速率和传输介质的问题，例题来源于阿里的《技术之瞳》。<br>要解决这样的题，我们首先要清晰其中的单位关系。</p>
<p>首先计算总时间：t = s %uF7 v = 1000 km %uF7 80 km / h = 12 .5 h<br>然后计算总时间内可以传输的数据量：<br>s2 GB = v2 %uD7 t = 1000 G b/s %uF7 8b/B %uD7 12.5 h %uD7 3600 s/h<br>         =  5625000 GB<br>(其中s2为总数据量，v2为传输速率)<br>(注意单位要一致，12.5小时要转为秒，1000G b/s 是bit每秒，而最后数据量的单位是byte，因为1 byte = 8 bit，所以要除上 8b/B)<br>最后用总的数据量除以每块硬盘的size就可以知道至少运送多少块了：<br>n = s2 GB %uF7 1024 GB/块 = 562500 GB %uF7 1024 GB/块 = 5494 块</p>
<h2 id="小总结"><a href="#小总结" class="headerlink" title="小总结"></a>小总结</h2><p>这类题目公式其实就是s=vt，主要要留意单位要一致。</p>
<h2 id="再来一题"><a href="#再来一题" class="headerlink" title="再来一题"></a>再来一题</h2><p><strong>有以下数据传输方法，请按照速率排序：</strong><br><strong>1.从一台计算机的A硬盘复制数据到B硬盘</strong><br><strong>2.通过10Gbit/s的局域网访问一台机器的内存</strong><br><strong>3.通过10Mbit/s的ADSL下载互联网资源</strong><br><strong>4.通过快递邮寄1TB硬盘，24小时内送达</strong></p>
<p>解：<br>首先我们可以确认的是四个答案的速率差距应该都是清晰。<br>1.硬盘的速度大概是60 MB/s<br>2.10G bit/s =&gt; 10 %uF7 8 b/s = 1.25GB/s = 1280 MB/s<br>3.10M bit/s =&gt; 10 %uF7 8 b/s = 1.25B /s ≈ 0.00125MB/s<br>4.1TB %uF7 24h =&gt; 1024 GB %uF7 8 b/s %uF7 24 %uD7 3600 s/h =&gt; 19200 B/s ≈ 19.2 MB/s<br>所以 2&gt;1&gt;4&gt;3</p>
<h2 id="大总结"><a href="#大总结" class="headerlink" title="大总结"></a>大总结</h2><p>就这样子了</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/07/31/log-system-build/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/31/log-system-build/" itemprop="url">项目日志系统设计和搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-31T00:00:00+08:00">
                2017-07-31
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/31/log-system-build/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/31/log-system-build/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="项目日志系统设计和搭建"><a href="#项目日志系统设计和搭建" class="headerlink" title="项目日志系统设计和搭建"></a>项目日志系统设计和搭建</h3><p><a href="/studyforinterview/2017/07/31/log-system-build/"><br>          2017-07-31
        </a></p>
<p><a href="/studyfortencent/tags/日志/">#日志</a></p>
<h2 id="缺少的Log"><a href="#缺少的Log" class="headerlink" title="缺少的Log"></a>缺少的Log</h2><p>个人负责的商城平台遇到一件事件，具体内容不方便公开，不过从中发现了一个比较重要的问题，就是系统中可以查找的log太少了。我们的平台基于的是shopnc商城，有些重要的位置没有记录用户的操作日志和用户IP信息之类，造成责任归属困难。所以上级要求我在重要的地方加添更多的Log点。</p>
<h2 id="当前系统"><a href="#当前系统" class="headerlink" title="当前系统"></a>当前系统</h2><p>当前系统用得较多的log就是member表里面记录的两次用户登录IP</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/07/28/dev-code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/28/dev-code/" itemprop="url">开发时候常会遇到的HTTP状态码</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-28T00:00:00+08:00">
                2017-07-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/28/dev-code/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/28/dev-code/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="开发时候常会遇到的HTTP状态码"><a href="#开发时候常会遇到的HTTP状态码" class="headerlink" title="开发时候常会遇到的HTTP状态码"></a>开发时候常会遇到的HTTP状态码</h3><p><a href="/studyforinterview/2017/07/28/dev-code/"><br>          2017-07-28
        </a></p>
<p><a href="https://superhos.github.io/studyforinterview/2017/07/25/起航/"><br>                        返回目录
                </a></p>
<p>关于HTTP协议，可以看我的而另一篇文章：<a href="https://superhos.github.io/studyforinterview/2017/08/10/http-protocal/">关于HTTP协议的一切</a></p>
<p>这篇查询用[0]</p>
<p>HTTP:Status 1xx (临时响应) 表示说临时响应并需要请求者继续执行操作<br>HTTP:Status 2xx (成功) 表示成功处理了请求<br>HTTP:Status 3xx (重定向) 表示要完成请求需要进一步操作。通常这些状态码用来重定向 。<br>HTTP:Status 4xx (错误) 表示请求可能出错，妨碍了服务器的处理<br>HTTP:Status 5xx (服务器错误) 表示服务器在尝试处理请求时发生了内部错误。这些错误可能是服务器本身引起的，而不是请求错误。</p>
<h3 id="常见状态码"><a href="#常见状态码" class="headerlink" title="常见状态码"></a>常见状态码</h3><p>200 (成功)<br>304 (未修改) 自上次请求后，请求的网页未修改过。服务器返回此响应时，不返回网页请求，客户端可以一般读取缓存。<br>401 (未授权) 请求要求身份验证。<br>403 (禁止) 服务器拒绝请求。<br>404 (未找到) 服务器找不到请求的网页<br>500 (服务器出错) 要看log找错了<br>504 (服务响应超时)</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[0]《技术之瞳》，阿里巴巴集团校园招聘笔试项目组</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/07/28/nginx-accesslog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/28/nginx-accesslog/" itemprop="url">最熟悉的陌生人 - access log</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-28T00:00:00+08:00">
                2017-07-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/28/nginx-accesslog/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/28/nginx-accesslog/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="最熟悉的陌生人-access-log"><a href="#最熟悉的陌生人-access-log" class="headerlink" title="最熟悉的陌生人 - access log"></a>最熟悉的陌生人 - access log</h3><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p> access log一直是我们服务端运维找问题的好帮手，但是作为一个偏应用层的开发者来说，可能会有着那么一点陌生，例如access log写入日志的时机是什么时候呢？谁能写？怎么配置等等，所以在这篇文章里面，我会试图从官方文档去找到所需要的一切的答案。</p>
<h2 id="什么是access-log"><a href="#什么是access-log" class="headerlink" title="什么是access log"></a>什么是access log</h2><p>顾名思义，access log就是用来记录用户的请求日志。可通过nginx的配置文件来配置他的保存位置和输出的日志格式。</p>
<h2 id="日志告诉了我们什么信息"><a href="#日志告诉了我们什么信息" class="headerlink" title="日志告诉了我们什么信息"></a>日志告诉了我们什么信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">176.51.166.239 - - [28/Jul/2017:15:41:30 +0800] &quot;POST /wp-login.php HTTP/1.1&quot; 200 2644 &quot;http://awesomesevens.com/wp-login.php&quot; &quot;Mozilla/5.0 (Windows NT 6.0; rv:34.0) Gecko/20100101 Firefox/34.0&quot;</span><br></pre></td></tr></table></figure>
<p>这是一条默认的日志，具体的内容我们参照官网给的默认格式来看：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">log_format main &apos;$remote_addr - $remote_user [$time_local] &apos;</span><br><span class="line"></span><br><span class="line">                           &apos;&quot;$request&quot; $status $body_bytes_sent &apos;</span><br><span class="line"></span><br><span class="line">                           &apos;&quot;$http_referer&quot; &quot;$http_user_agent&quot;;</span><br></pre></td></tr></table></figure>
<ol>
<li><p>176.51.166.239<br>$remote_addr : 客户端(用户)的请求IP</p>
</li>
<li><p>-<br>$remote_user : 已经经过Auth Basic Module验证的用户名。”-“就是没有记录到。</p>
</li>
<li><p>[28/Jul/2017:15:41:30 +0800]<br>$time_local  : 记录的时间</p>
</li>
<li><p>“POST /wp-login.php HTTP/1.1”<br>$request : 请求的url，POST 为请求的方法，HTTP/1.1为请求的协议</p>
</li>
<li><p>200<br>$status : 请求的状态，具体的状态代表的意义可以看我的另一篇文章 <a href="https://superhos.github.io/studyforinterview/2017/07/28/dev-code/">开发时候常会遇到的状态码</a></p>
</li>
<li><p>2644<br>$body_bytes_sent : 传送页面的字节数</p>
</li>
<li><p><a href="http://awesomesevens.com/wp-login.php" target="_blank" rel="noopener">http://awesomesevens.com/wp-login.php</a><br>$http_referer : 来源页面，即从哪个页面转到本页</p>
</li>
<li><p>Mozilla/5.0 (Windows NT 6.0; rv:34.0) Gecko/20100101 Firefox/34.0<br>$http_user_agent : 用户的浏览器信息，终端，版本等</p>
</li>
</ol>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>配置也很简单，在nginx config的server配置中加入下面一句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">access_log  /var/log/nginx/access.log  main;</span><br></pre></td></tr></table></figure>
<p>中间是要放置的log的地址，后面的main对应的是上一节设定的格式。</p>
<h2 id="access太大怎么办"><a href="#access太大怎么办" class="headerlink" title="access太大怎么办"></a>access太大怎么办</h2><p>我的建议是如果访问量大得夸张的话，最好把日志一块交给应用层去做，抽出来做一个日志系统，方便后续的分析。<br>如果访问量还没到夸张的层次的时候，也要考虑日志的占用空间问题。所以对每天的日志进行压缩和转存就很有必要了。网上的有人用的是写shell+crontab来做，但其实linux本来已经提供了一个很好的工具给我们去做这件事情，叫logrotate。<br>一般logrotate的配置文件会放置在 <em>/etc/logrotate.d</em> 路径下，下面是我的一个logrotate对于nginx日志的配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/var/log/nginx/*.log &#123;</span><br><span class="line"></span><br><span class="line">        daily</span><br><span class="line"></span><br><span class="line">        missingok</span><br><span class="line"></span><br><span class="line">        rotate 14</span><br><span class="line"></span><br><span class="line">        compress</span><br><span class="line"></span><br><span class="line">        delaycompress</span><br><span class="line"></span><br><span class="line">        notifempty</span><br><span class="line"></span><br><span class="line">        create 0640 www-data adm</span><br><span class="line"></span><br><span class="line">        sharedscripts</span><br><span class="line"></span><br><span class="line">        prerotate</span><br><span class="line"></span><br><span class="line">                if [ -d /etc/logrotate.d/httpd-prerotate ]; then \</span><br><span class="line"></span><br><span class="line">                        run-parts /etc/logrotate.d/httpd-prerotate; \</span><br><span class="line"></span><br><span class="line">                fi \</span><br><span class="line"></span><br><span class="line">        endscript</span><br><span class="line"></span><br><span class="line">        postrotate</span><br><span class="line"></span><br><span class="line">                invoke-rc.d nginx rotate &gt;/dev/null 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line">        endscript</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参数 功能<br>compress 通过gzip 压缩转储以后的日志<br>nocompress 不需要压缩时，用这个参数<br>copytruncate 用于还在打开中的日志文件，把当前日志备份并截断<br>nocopytruncate 备份日志文件但是不截断<br>create mode owner group 转储文件，使用指定的文件模式创建新的日志文件<br>nocreate 不建立新的日志文件<br>delaycompress 和 compress 一起使用时，转储的日志文件到下一次转储时才压缩<br>nodelaycompress 覆盖 delaycompress 选项，转储同时压缩。<br>errors address 专储时的错误信息发送到指定的Email 地址<br>ifempty 即使是空文件也转储，这个是 logrotate 的缺省选项。<br>notifempty 如果是空文件的话，不转储<br>mail address 把转储的日志文件发送到指定的E-mail 地址<br>nomail 转储时不发送日志文件<br>olddir directory 转储后的日志文件放入指定的目录，必须和当前日志文件在同一个文件系统<br>noolddir 转储后的日志文件和当前日志文件放在同一个目录下<br>prerotate/endscript 在转储以前需要执行的命令可以放入这个对，这两个关键字必须单独成行<br>postrotate/endscript 在转储以后需要执行的命令可以放入这个对，这两个关键字必须单独成行<br>daily 指定转储周期为每天<br>weekly 指定转储周期为每周<br>monthly 指定转储周期为每月<br>rotate count 指定日志文件删除之前转储的次数，0 指没有备份，5 指保留5 个备份<br>tabootext [+] list 让logrotate 不转储指定扩展名的文件，缺省的扩展名是：.rpm-orig, .rpmsave, v, 和 ~<br>size size 当日志文件到达指定的大小时才转储，Size 可以指定 bytes (缺省)以及KB (sizek)或者MB (sizem).</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/07/25/参考书籍/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/25/参考书籍/" itemprop="url">参考书籍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-25T00:00:00+08:00">
                2017-07-25
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/25/参考书籍/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/25/参考书籍/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="参考书籍"><a href="#参考书籍" class="headerlink" title="参考书籍"></a>参考书籍</h3><p><a href="/studyforinterview/tags/参考/">#参考</a></p>
<h3 id="书籍"><a href="#书籍" class="headerlink" title="书籍"></a>书籍</h3><p>[1]《技术之瞳》，阿里巴巴集团校园招聘笔试项目组<br>[2]《Vue.js权威指南》，张耀春，黄轶，王静，苏伟等著<br>[3]《你不知道的JavaScript 上卷/中卷》，[美] Kyle Simpson</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/07/25/basic-character/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/25/basic-character/" itemprop="url">【翻译】每个程序员都需要了解的Unicode和字符集知识</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-25T00:00:00+08:00">
                2017-07-25
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/25/basic-character/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/25/basic-character/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="【翻译】每个程序员都需要了解的Unicode和字符集知识"><a href="#【翻译】每个程序员都需要了解的Unicode和字符集知识" class="headerlink" title="【翻译】每个程序员都需要了解的Unicode和字符集知识"></a>【翻译】每个程序员都需要了解的Unicode和字符集知识</h3><p><a href="/studyforinterview/2017/07/25/basic-character/"><br>          2017-07-25
        </a></p>
<p><a href="https://superhos.github.io/studyforinterview/2017/07/25/起航/"><br>                        返回目录
                </a></p>
<p><a href="/studyforinterview/tags/字符集/">#字符集</a></p>
<p>原文: <a href="https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/" target="_blank" rel="noopener">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</a></p>
<p>翻译：陈昊（Sevenschan）</p>
<blockquote>
<p>PS: 从来没有翻译过一篇文章的作者这么喜欢讲段子。。翻译起来很费劲。。而且真正有用的干货说实话不多。。</p>
</blockquote>
<p>有对那个神秘的Content-Type标签产生过好奇吗？当把它放在HTML里面之后会发生什么你不知道的事呢？</p>
<p>你试过收到一封来自保加利亚的朋友的email，但是都是一堆“???? ????????? ????????? ???”吗?</p>
<p>我很伤心的发现有很多的程序员都不能完全的了解字符集、编码、Unicode等等的神秘世界。几年前，一个FogBUGZ的测试人员想知道是否可以用日语来处理收到的电子邮件。日语？他们有收到日语的邮件（是不是哪个不可言喻的网站的验证邮件）？人家很傻很天真一点都不懂哟。当我仔细看看我们用来解析MME邮件信息的商业ActiveX控件的时候，我们发现它对于字符集的处理是错得离谱，所以我们不得不写一段英雄般的代码来逆转错误并且重做一遍正确的。当我查看另外的商业库的时候，mmp，一个样，字符都被搞得支离破碎。我跟这些库的作者反应，得到的回答是他们“没有任何办法”。</p>
<p>同时，我发现世界第一的语言PHP几乎完全无视字符编码问题，因为它使用8位字符，这样的设计使它几乎没有可能开发优秀的国际化应用。我想，足够就是最好了吗。</p>
<p>所以我发布了一个公告：如果你是2003年以后的程序员，但你不知道关于字符的基础知识，不知道字符集，不知道编码，不知道unicode的话，老子会捉住你，然后把你晾在游艇上半年。我发誓我会这样做的。</p>
<p>更重要的一点事： <strong>它其实一点都不难</strong></p>
<p>在这篇文章里，我会把每个工作的程序员都需要知道的点都塞进你的脑袋里。要你知道 “plain text = ascii = 8位字符” 不仅是错，是大错特错。你就像那些不相信细菌的医生一样。所以，请你求求你在看完这篇文章以前，不要再写一句代码了。</p>
<p>在我开始之前【译者注：这篇文章的前戏真长。。】，我应该提醒你如果你是那些罕见的熟悉国际化的人，你会发现我谈论的点都是很浅显的。我是真的只是尝试去设置最低界线，来帮助各位可以编写更好的代码。还有一点，字符集只是在系统国际化中的一个小部分，我也只能在一篇文章里面谈论一个小部分，反正老子说了算。</p>
<h2 id="历史观"><a href="#历史观" class="headerlink" title="历史观"></a>历史观</h2><p>最简单了解这些东西的方法就是看看它们的时间线。</p>
<p>你可能会以为我要讲老掉牙的字符集，例如EBCDIC。嘿嘿，老子怎么会被你们凡人猜到。 EBCDIC已经跟你们的生活毫无关系了，我们也不需要讲到那么远的历史。</p>
<p>回到半年后，当Unix出世以后并且K&amp;R还在写C语言的时候，所有东西都很简单。EBCDIC就是使用的方案。唯一有关系的老的好的字符就是英文字母，我们把它成为ASCII，允许它们使用32到127之间的每个数字来表示每个字符。 空格是32，大写字母“A”是65,等等。这样可以很方便的保存在7位（bit）里。现代电脑大部分都是使用8位字节，因此你不仅可以存储每一个ASCII字符，你还有很多位置去做坏事，你可以存一些稀奇古怪的字符。少于32位的代码称为不可打印代码。</p>
<p>一切都很好，假设你的母语是英语。因为我们用8位去存储字符，很多人就会都想到：“嘿嘿，我们可以用128-255位置来存储我们自己的符号。”<img src="https://i0.wp.com/www.joelonsoftware.com/wp-content/uploads/2003/10/oem.png?resize=271,209&amp;ssl=1" alt="image"> 麻烦的是，太多人在同一时间有这个想法了，对于这些富余的位置各有各想法各有各精彩。IBM的电脑提供了一堆叫OEM字符的东西，用来提供欧洲的重音字符和一堆线条。。横的、竖的、垂直右边有个小铃铛的等等。你可以用这些线条字符在屏幕上去堆一个精美的盒子出来，实际上你依然可以在使用8088电脑的干衣机上看到它们的身影。实际上，随着美国以外的人们开始买属于自己的电脑以后，不同的128个字母都被赋予了他们各人的目的。例如，在一些电脑上面字符编码130会显示%uE9，但是在以色列的电脑上它就会显示 %u5D2。所以当美国人想发送他们的r%uE9sum%uE9s 到以色列的话，就会变成了r%u5D2sum%u5D2s。在很多案例中，例如俄罗斯，他们对这128位之后的字符编码的使用有着大量不同的想法，所以你很难去可靠的交换俄罗斯的文件。</p>
<p>最后，OEM决定编纂ANSI标准。在ANSI标准里面，所有人都同意如何使用128位以下的位，这几乎与ASCII相同，但是从128位开始到最后一个编码位的使用就大有不同。这些不同的系统被称为编码页（Code Page）。例如在以色列的DOS里面使用的编码页被称为862，希腊用户用的称为737。他们使用的128位以下都是相同的，但是从128位以后开始就充斥了各种有趣的字母了。MS-DOS国家版本里面有几十个这些编码页，可以处理英语到冰岛语，甚至还可以在同一台电脑里面处理世界语和加利亚语！屌爆！但是，希伯来语和希腊语在同一台计算机上是完全不可能的，除非你编写自己的自定义程序用来显示所有使用位图的图形，因为希伯来语和希腊语需要不同的编码页与高数字。</p>
<p>与此同时，亚洲有着成千上百个字符，这些远远不能放进8位里面。这一样会通过称为DBCS的五花八门的系统来解决，“双字节字符集”里面存着字符一些占用了一个字节，一些占用了两个字节。这样在一个字符串中很容易可以向前移，但是很难向后移。程序员最好不要使用s++和s-去向前或者向后移字符串，鼓励使用例如window里面AnsiNext和AnsiPrev的方法来避免混乱。</p>
<p>但是，只要从来不把一个字符串移动到另一台电脑的话，或者不讲另一种语言的话，把一个字节当作一个字符或者把一个字符当作是八位是可行的。但当然，随着互联网发展，字符串从一台电脑发送到另一台电脑变得相当普遍。就在这个时候，Unicode出现了。</p>
<h2 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h2><p>Unicode致力于创造一个可以适应所有地球上操作系统的单一字符集。有些人误解Unicode只是一个简单的16位编码，每个字符占用16位所以只能保存65536个字符。这！一点！都不对！这是一个属于Unicode的神话，你不懂别bb。</p>
<p>实际上，关于字符，Unicode有自己的一套独到的思考方式，如果你不能了解它的想法，你会感受不到它的好。</p>
<p>现在，我们来假设一个字母映射到一些位中，你可以把它存在硬盘或者内存中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A -&gt; 0100 0001</span><br></pre></td></tr></table></figure>
<p>在Unicode中，一个字母映射会被映射到一个称为 <em>编码点</em> [0]的东西上，当然它只是一个概念。如何将 <em>编码点</em> 在硬盘或者内存中表现出来才是完整的故事。</p>
<p>在Unicode中，字母A只是一个柏拉图式的念想，只是漂浮在天堂上：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A</span><br></pre></td></tr></table></figure></p>
<p>这个柏拉图式的A跟B不一样，跟a也不一样，但是跟A 和 <em>A</em> 和 <strong>A</strong> 都一样。不同字体之间的字符A 都是代表同一个A，但是不同于小写 “a”，看起来无可非议，但是在一些语言里面弄清楚一个字母是有很多争议的。德国的字母 %uDF 是真实存在的字母还是只是一种特殊的写作方式？如果一个字母在单词里面最后一笔发生了变化，这是一个新的字母吗？Hebrew说是的，Arabic说不是。无论如何，在Unicode联盟里面的那堆聪明人经过大量的讨论辩论，这些问题已经解决了。</p>
<p>每个柏拉图式的字母会由Unicode联盟通过每个字母表来赋予一个魔术代码给它们，它是这个样子的：<strong>U+0639</strong> 。 这个魔术代码就是 <em>编码点</em> 。 编码点里面的 U+ 代表 “Unicode” ，后面的数字是十六进制数。 <strong>U+0639</strong> 是阿拉伯的字母 Ain。 英语的字母A则是 <strong>U+0041</strong> 。你可以通过 Windows 2000/xp 里面的 <strong>charmap</strong> 来查询它们，或者登陆<a href="http://www.unicode.org/" target="_blank" rel="noopener">Unicode官网</a>查询。</p>
<p>Unicode可以定义的字母数量并没有真正的限制，实际上它们超过了65,536，所以不是每个unicode字母都可以被压缩成两个字节，这只是一个神话。</p>
<p>好的，我们现在来个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Hello</span><br></pre></td></tr></table></figure>
<p>在Unicode里面，对应的五个编码点是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">U+0048 U+0065 U+006C U+006C U+006F</span><br></pre></td></tr></table></figure>
<p>反正就是一堆编码点数字什么的了。谈到这里，我们还没有提到如何把这些编码保存在内存里面和如何在一封电子邮件里面重现。</p>
<h2 id="Encodings-（编码）"><a href="#Encodings-（编码）" class="headerlink" title="Encodings （编码）"></a>Encodings （编码）</h2><p>是时候让 <em>编码</em> 出场啦。<br>Unicode编码最早的想法就是来源于那个两个字节的神话，只需要将这些数字分别存在两个字节里。就变成这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">00 48 00 65 00 6C 00 6C 00 6F</span><br></pre></td></tr></table></figure>
<p>是吧？好像不太快吧？不可以是这样吗？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">48 00 65 00 6C 00 6C 00 6F 00</span><br></pre></td></tr></table></figure>
<p>在技术上，我相信可以做到的。事实上，每个实现者都希望以高地址和低地址的模式【译者注：这里提到的可以去看一下字节对齐更好理解】来存储他们的Unicode编码点。这样的话无论是任何CPU来处理，速度都是相当快的。所以人们不得不提出在每个Unicode字符串的开头存储一个FE FF的奇怪约定;这个被称为  Unicode Byte Order Mark（BOM），如果你交换了你的高低字节，那么它将会看起来是 FF FE 这样，那么其他人读到你的字符串的时候就可以知道需要把字节交换回来了。 当然了，不是每个Unicode 字符串开头都会有BOM标记的。<br><img src="https://i2.wp.com/www.joelonsoftware.com/wp-content/uploads/2003/10/hummers.jpg?resize=390,61&amp;ssl=1" alt="image"></p>
<p>这看起来已经相当好了，当时有些程序员会抱怨。“看看那些 0 ！”，他们说。因为美国人很少会用高于 U+00FF 的编码点。【译者注：然后这里一段都是讽刺德州人和加州人。。没什么营养，略去。】大意就是这些用惯了ANSI和DBCS字符集的人懒得转换使用Unicode，并且固定长度的Unicode会导致一些字符会保存大量的0字节，因此Unicode被忽略了很多年。</p>
<p>因此，辉煌的UTF-8被提出了。 UTF-8是使用另一个系统来存储你的Unicode编码点字符串，那些模式U+数字在内存里使用8位字节,而在UTF-8里面，每个0-127的编码点都被存在了一个独立的字节里。只有当编码点大于等于128的时候才会只用第二第三个字节，实际上，最高可以允许使用六个字节。</p>
<p><img src="https://i1.wp.com/www.joelonsoftware.com/wp-content/uploads/2003/10/utf8.png?resize=400,63&amp;ssl=1" alt="image"></p>
<p>这种做法使得UTF-8看起来就跟ASCII一样整洁，因此美国佬没有发现出区别。<br>只有世界上其他的人才能跳出思维圈圈。具体来说，<strong>Hello</strong>， 编码点串为 U+0048 U+0065 U+006C U+006C U+006F，会被保存为48 65 6C 6C 6F。看啊哇塞！这跟保存在ASCII或者地球上其他的OEM字符集都一样啊！现在，你可以大胆地使用重音字母或者希腊字母或者克林贡字母，即使你不得不使用几个字节来保存一个编码点，但是美国佬们永远都不会注意到。（UTF-8也有一个不错的属性，那个想要使用单个0字节作为空终止符的无效旧字符串处理编码不会被截断）。</p>
<p>到目前为止，我已经讲述了三种Unicode编码。传统的保存在两个字节的方法被称为UCS-2（因为它有两个字节）或者UTF-16 （因为它有16位），而且你依然需要区分这是高位UCS-2还是低位UCS-2。还有很受欢迎的UTF-8。</p>
<p>实际上有一些其他的Unicode编码方法。 有一个叫UTF-7，非常像UTF-8，但是它保证高位总是为零，因此如果你要通过某种恶意的警察邮件系统来传递Unicode，UTF-7是足够的了。还以一种UCS-4，会把每个编码点保存到4个字节里面，优点是每个编码点都能草存到相同大小的字节里面，但是，节俭的德州人会很在意这些浪费的。</p>
<p>事实上，你正在思考使用Unicode编码点来表示柏拉图式字母，那些Unicode编码点也可以用任何老式的编码方案进行编码！举个例子，你可以对Unicode字符串Hello (U+0048 U+0065 U+006C U+006C U+006F) 进行ASCII编码，或者古老的OEM希腊语编码，或者Hebrew ANSI 编码，或者任何其他有上百年历史的编码方式。你会发现，都会是相同的结果：一些字母不会被显示出来！它会显示：? 或者�。</p>
<p>几百种传统的编码方法都只能正确的保存部分编码点，其他的编码点都会显示问号。一些流行的英文文本编码是Windows-1252（西欧语言的Windows 9x标准）和ISO-8859-1（也称为拉丁语1）（也适用于任何西欧语言）在尝试保存俄文或者Hebrew字母的时候，都会得到一大堆问号。UTF 7，8，16和32则再这方面都有着很好的表现。</p>
<h2 id="关于编码的一个重要的事实"><a href="#关于编码的一个重要的事实" class="headerlink" title="关于编码的一个重要的事实"></a>关于编码的一个重要的事实</h2><p>如果你已经忘光了我刚刚解释的一切，请记住一个事实。只有字符串而不知道它使用的编码，这是毫无意义的。你不可以再把头埋在洞里，假装这个文本使用的是ASCII。</p>
<blockquote>
<p>没有没有这样的事情作为纯文本</p>
</blockquote>
<p>如果你有一个字符串在内存，在文件或者在电子邮件信息中，你必须知道它使用的编码否则你不能正确地读到它。</p>
<p>“我的网站看起来乱七八糟”或者“她不能看懂我的电子邮件当我说了重音拼音”等等这些愚蠢的问题都归咎于天真的程序员，由于他根本不知道你的信息所使用的编码。</p>
<p>我们能不能找到有用的信息来显示字符串使用的编码方式呢？答案是有的，我们通过标准的方法来达到这个目的。对于电子邮件信息，你应该在表单的头部有一个字符串。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Content-Type: text/plain; charset=”UTF-8″</span><br></pre></td></tr></table></figure></p>
<p>对于网页来说，最初的想法是网站服务器会返回一个类似 <strong>Content-Type</strong> 的HTTP头部信息以及网页本身 —— 不是HTML本身，作为在HTML页面发送之前的响应头之一。</p>
<p>但这会引起问题。假设你有很大的WEB服务器，拥有大量的页面和成百上千的页面是由不同语言的人提供的，那么所有使用的编码将会由Microsoft FrontPage选择认为适合的编码方法来生成。Web服务器本身不会真正知道每个文件的编码方式，因此无法发送Content-Type头文件。</p>
<p>如果你可以使用某种特殊标签将HTML文件的Content-Type正确放置在HTML文件本身，那将会很方便。当然，这会让纯粹主义者疯狂…你怎么能通过读HTML文件来确定什么编码？幸运的是，几乎每个常用的编码间32到127之间的字符都相同，所以你可以随时在HTML页面上得到这个，而不用担心使用“有趣”的字母：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;meta http-equiv=“Content-Type” content=“text/html; charset=utf-8”&gt;</span><br></pre></td></tr></table></figure></p>
<p>要记住这个meta标签必须是块里面非常靠前定义的标签，因为当浏览器看到这个标签的时候就会停止页面的解析并且开始使用你指定的编码重新开始解析整个页面。</p>
<p>当浏览器找不到定义 <strong>Content-Type</strong> 的meta 标签而且http头也没有定义的时候怎么办？IE浏览器通常会做一个有趣的事情：它会尝试去猜测，基于各种语言的典型编码中的各种字节出现在典型文本中的频率，来决定使用什么语言和编码【译者注：IE大哥别乱猜啊。。】。因为各种旧的8位编码页往往将其国家字母放在128到255之间的不同范围内，并且因为每种人类语言都有不同的字母使用特征直方图，这实际上有一个可行的机会。这真的很奇怪，但这看起来的确可行，直到有一天他们写了一些完全不能根据字母频率分布来确认语言的东西出来，IE判定它是韩语并显示出来，证明这不是很好的方法。</p>
<p>这篇文章变得很长，我不可能涵盖所有关于字符编码和Unicode的知识，但是我希望如果你已经读到这里的话，尝试去更多的地方去了解Unicode，会让你更获益良多。</p>
<h3 id="注"><a href="#注" class="headerlink" title="注"></a>注</h3><p>[0] 编码点，Code point，不同地方也有翻译成码点或代码点。</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://superhos.github.io/2017/07/25/语言的选择/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SevensChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sevens Chan blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/25/语言的选择/" itemprop="url">语言的选择</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-25T00:00:00+08:00">
                2017-07-25
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/25/语言的选择/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/25/语言的选择/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="语言的选择"><a href="#语言的选择" class="headerlink" title="语言的选择"></a>语言的选择</h3><p><a href="/studyforinterview/tags/PHP/">#PHP</a></p>
<p>我目前主要负责的也是前端以及后端的api开发，所以这里算法的话会以js为主，后面会整理php以及js的深入内容。</p>
<h3 id="最后选择"><a href="#最后选择" class="headerlink" title="最后选择"></a>最后选择</h3><ul>
<li>PHP</li>
<li>JS</li>
</ul>
<p>根据复习的语言，也决定了我的投递岗位：</p>
<ul>
<li>PHP开发工程师</li>
<li>前端开发工程师</li>
<li>Node.js开发工程师</li>
</ul>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="SevensChan" />
          <p class="site-author-name" itemprop="name">SevensChan</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">71</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-SEVENS CHAN"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SevensChan</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  

    
      <script id="dsq-count-scr" src="https://sevenschan.disqus.com/count.js" async></script>
    

    

  











  





  

  

  

  

  

  

</body>
</html>
